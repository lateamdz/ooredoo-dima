!function(){"use strict";var e=null,e=void 0===window.videojs&&"function"==typeof require?require("video.js"):window.videojs;!function(s){var e,a={ui:!0},r=s.getComponent("MenuItem"),l=s.extend(r,{constructor:function(e,t){t.selectable=!0,r.call(this,e,t),this.src=t.src,e.on("resolutionchange",s.bind(this,this.update))}});l.prototype.handleClick=function(e){r.prototype.handleClick.call(this,e),this.player_.currentResolution(this.options_.label)},l.prototype.update=function(){var e=this.player_.currentResolution();this.selected(this.options_.label===e.label)},r.registerComponent("ResolutionMenuItem",l);var n=s.getComponent("MenuButton"),c=s.extend(n,{constructor:function(e,t){var r;this.label=document.createElement("span"),t.label="Quality",n.call(this,e,t),this.el().setAttribute("aria-label","Quality"),this.controlText("Quality"),t.dynamicLabel?(s.addClass(this.label,"vjs-resolution-button-label"),this.el().appendChild(this.label)):(r=document.createElement("span"),s.addClass(r,"vjs-menu-icon"),this.el().appendChild(r)),e.on("updateSources",s.bind(this,this.update))}});c.prototype.createItems=function(){var e=[],t=this.sources&&this.sources.label||{};for(var r in t)t.hasOwnProperty(r)&&e.push(new l(this.player_,{label:r,src:t[r],selected:r===(!!this.currentSelection&&this.currentSelection.label)}));return e},c.prototype.update=function(){return this.sources=this.player_.getGroupedSrc(),this.currentSelection=this.player_.currentResolution(),this.label.innerHTML=this.currentSelection?this.currentSelection.label:"",n.prototype.update.call(this)},c.prototype.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-resolution-button"},n.registerComponent("ResolutionMenuButton",c),e=function(e){var o=s.mergeOptions(a,e),i=this;function r(e,t){return e.res&&t.res?t.res-e.res:0}function u(e){var t={label:{},res:{},type:{}};return e.map(function(e){l(t,"label",e),l(t,"res",e),l(t,"type",e),n(t,"label",e),n(t,"res",e),n(t,"type",e)}),t}function l(e,t,r){null==e[t][r[t]]&&(e[t][r[t]]=[])}function n(e,t,r){e[t][r[t]].push(r)}function t(l){function n(e,t,r){return l.tech_.ytPlayer.setPlaybackQuality(t[0]._yt),l.trigger("updateSources"),l}var s={highres:{res:1080,label:"1080",yt:"highres"},hd1080:{res:1080,label:"1080",yt:"hd1080"},hd720:{res:720,label:"720",yt:"hd720"},large:{res:480,label:"480",yt:"large"},medium:{res:360,label:"360",yt:"medium"},small:{res:240,label:"240",yt:"small"},tiny:{res:144,label:"144",yt:"tiny"},auto:{res:0,label:"auto",yt:"auto"}};o.customSourcePicker=n,l.tech_.ytPlayer.setPlaybackQuality("auto"),l.tech_.ytPlayer.addEventListener("onPlaybackQualityChange",function(e){for(var t in s)if(t.yt===e.data)return void l.currentResolution(t.label,n)}),l.one("play",function(){var e=l.tech_.ytPlayer.getAvailableQualityLevels(),t=[];e.map(function(e){t.push({src:l.src().src,type:l.src().type,label:s[e].label,res:s[e].res,_yt:s[e].yt})}),l.groupedSrc=u(t);var r={label:"auto",res:0,sources:l.groupedSrc.label.auto};this.currentResolutionState={label:r.label,sources:r.sources},l.trigger("updateSources"),l.setSourcesSanitized(r.sources,r.label,n)})}i.updateSrc=function(e){if(!e)return i.src();e=e.filter(function(e){try{return""!==i.canPlayType(e.type)}catch(e){return!0}}),this.currentSources=e.sort(r),this.groupedSrc=u(this.currentSources);var t=function(e,t){var r=o.default,l="";"high"===r?(r=t[0].res,l=t[0].label):"low"!==r&&null!=r&&e.res[r]?e.res[r]&&(l=e.res[r][0].label):(r=t[t.length-1].res,l=t[t.length-1].label);return{res:r,label:l,sources:e.res[r]}}(this.groupedSrc,this.currentSources);return this.currentResolutionState={label:t.label,sources:t.sources},i.trigger("updateSources"),i.setSourcesSanitized(t.sources,t.label),i.trigger("resolutionchange"),i},i.currentResolution=function(e,t){if(null==e)return this.currentResolutionState;if(this.groupedSrc&&this.groupedSrc.label&&this.groupedSrc.label[e]){var r=this.groupedSrc.label[e],l=i.currentTime(),n=i.paused();!n&&this.player_.options_.bigPlayButton&&this.player_.bigPlayButton.hide();var s="loadeddata";return"Youtube"!==this.player_.techName_&&"none"===this.player_.preload()&&"Flash"!==this.player_.techName_&&(s="timeupdate"),i.setSourcesSanitized(r,e,t||o.customSourcePicker).one(s,function(){i.currentTime(l),i.handleTechSeeked_(),n||i.play().handleTechSeeked_(),i.trigger("resolutionchange")}),i}},i.getGroupedSrc=function(){return this.groupedSrc},i.setSourcesSanitized=function(e,t,r){return this.currentResolutionState={label:t,sources:e},"function"==typeof r?r(i,e,t):(i.src(e.map(function(e){return{src:e.src,type:e.type,res:e.res}})),i)},i.ready(function(){var e;o.ui&&(e=new c(i,o),i.controlBar.resolutionSwitcher=i.controlBar.el_.insertBefore(e.el_,i.controlBar.getChild("fullscreenToggle").el_),i.controlBar.resolutionSwitcher.dispose=function(){this.parentNode.removeChild(this)}),1<i.options_.sources.length&&i.updateSrc(i.options_.sources),"Youtube"===i.techName_&&t(i)})},s.plugin("videoJsResolutionSwitcher",e)}((window,e))}();